# Работа с дисками

Статья норм: [https://serveradmin.ru/nastrojka-diskov-v-debian/](https://serveradmin.ru/nastrojka-diskov-v-debian/)

## hwinfo

Просмотр информации о физ дисках

## fdisk

Просмотр информации о физ дисках с привязкой к логическим

Все физические диски: `fdisk -l`

## Форматирование диска

ext4 - default fs type for debian

```
mkfs -t ext4 /dev/sda1
```

## Монтирование при загрузке

blkid - посмотреть UUID диска нового

В /etc/fstab добавить запись

Обязательно следите за тем, чтобы в конце файла fstab был переход на новую пустую строку. Это важно. Если не сделать переход на пустую строку, система не загрузится.

Править надо крайне осторожно

## mount

Работа с сетевыми дисками

### SMB

```
mount -t cifs //10.1.4.4/backup /mnt/backup -o user=admin,password=passadmin
```

Если команда не отработает и будет ошибка, установите отдельно **cifs-utils**.

```
# apt install cifs-utils
```

С монтированием по smb есть куча нюансов. Сколько различных ошибок я ловил при этом - не счесть. То кодировка не совпадает, то в пароле спец. символы, то шара в домене и надо правильно указать домен. Если в пароле есть спец. символы, пароль можно взять в одинарные кавычки. Домен можно указать через слеш, через плюс, через @. Пробуйте разные варианты, если не получается. Так же имя пользователя с доменом можно тоже брать в кавычки, иногда помогает. Например, вот так - 'domain\admin'. Так же обращайте внимание на версию протокола smb. Ее можно принудительно указывать через опцию _vers_. Так же можно вывести более подробный лог подключения.

```
# mount -t cifs -vvv //10.1.4.4/backup /mnt/backup -o vers=2.1,user=admin,password=passadmin
```

### NFS

Для подключения сетевого диска по nfs, необходимо установить на машину nfs-client, который находится в пакете **nfs-common**.

```
# apt install nfs-common
```

После этого можете подключить сетевую папку по nfs:

```
# mount -t nfs 10.1.4.4:/backup /mnt/backup
```

С nfs, так же как и с cifs, можно вывести расширенный лог и принудительно указать версию.

```
# mount -t nfs -vvv -overs=2 10.1.4.4:/backup /mnt/backup
```

Перед подключением диска можете проверить, а если вам вообще доступ к сетевому диску на сервере:

```
# showmount --exports 10.1.4.4
```

Вы должны увидеть список nfs дисков, к которым у вас есть доступ. Если список пуст, подмонтировать ничего не получится.

